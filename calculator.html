<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sleek Web Calculator</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #E0F7FA; /* Light Sky Blue for a cheerful background */
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }
        /* Custom button styling */
        .calc-button {
            @apply p-4 rounded-xl text-2xl font-semibold transition duration-150 shadow-lg;
            user-select: none; /* Prevent text selection */
            cursor: pointer;
            width: 100%;
            height: 100%;
        }
        /* Bright and cheerful button colors */
        .num-button {
            @apply bg-pink-100 text-gray-800 hover:bg-pink-200 active:bg-pink-300; /* Light Pink numbers */
        }
        .op-button {
            @apply bg-teal-400 text-white hover:bg-teal-300 active:bg-teal-500; /* Bright Teal operators */
        }
        .clear-button {
            @apply bg-orange-300 text-gray-800 hover:bg-orange-200 active:bg-orange-400; /* Soft Orange clears/functions */
        }
        .eq-button {
            @apply bg-lime-400 text-gray-800 hover:bg-lime-300 active:bg-lime-500; /* Vibrant Lime Green equals */
        }
    </style>
</head>
<body>

    <div class="calculator bg-white p-6 rounded-3xl shadow-xl w-full max-w-sm transition-all duration-300" id="calculator-body">

        <!-- Mode Selector -->
        <div class="mb-4">
            <label for="mode-select" class="text-sm text-gray-600 block mb-1">Select Mode:</label>
            <select id="mode-select" onchange="switchMode(this.value)" class="w-full p-2 rounded-lg bg-gray-100 text-gray-800 border border-gray-300 focus:ring-teal-400 focus:border-teal-400">
                <option value="standard">Standard</option>
                <option value="scientific">Scientific</option>
                <option value="programmer">Programmer</option>
                <option value="finance">Finance</option>
            </select>
        </div>

        <!-- Display -->
        <div class="display mb-6 p-4 bg-yellow-50 rounded-xl text-right overflow-hidden border border-gray-200">
            <!-- Current input/result -->
            <div id="previous-display" class="text-gray-500 text-lg h-6 overflow-hidden">0</div>
            <!-- Main active input -->
            <div id="current-display" class="text-gray-900 text-5xl font-extrabold h-14 overflow-x-scroll whitespace-nowrap">0</div>
        </div>

        <!-- Scientific Buttons (Appears in Scientific Mode) -->
        <div id="scientific-buttons" class="grid grid-cols-4 gap-3 mb-3 hidden">
            <!-- Row of Scientific Functions -->
            <button onclick="calculator.squareRoot()" class="calc-button clear-button text-xl">&radic;x</button>
            <button onclick="calculator.square()" class="calc-button clear-button text-xl">x<sup class="text-sm">2</sup></button>
            <button onclick="calculator.percent()" class="calc-button clear-button">%</button>
            <button onclick="calculator.changeSign()" class="calc-button clear-button">+/-</button>
        </div>
        
        <!-- Programmer Buttons (Appears in Programmer Mode) -->
        <div id="programmer-buttons" class="grid grid-cols-4 gap-3 mb-3 hidden">
            <button onclick="calculator.toBinary()" class="calc-button op-button text-xl">BIN</button>
            <button onclick="calculator.toHex()" class="calc-button op-button text-xl">HEX</button>
            <button onclick="calculator.andOp()" class="calc-button op-button text-xl">AND</button>
            <button onclick="calculator.orOp()" class="calc-button op-button text-xl">OR</button>
        </div>

        <!-- Finance Buttons (Appears in Finance Mode) -->
        <div id="finance-buttons" class="grid grid-cols-4 gap-3 mb-3 hidden">
            <button onclick="calculator.mockFV()" class="calc-button eq-button text-xl col-span-2">FV (Future Value)</button>
            <button onclick="calculator.mockPMT()" class="calc-button op-button text-xl col-span-2">PMT (Payment)</button>
        </div>

        <!-- Main Buttons Grid (5 rows x 4 columns) -->
        <div class="grid grid-cols-4 grid-rows-5 gap-3">
            
            <!-- Row 1: Clear and basic operators -->
            <button onclick="calculator.clear()" class="calc-button clear-button col-span-2">C</button>
            <button onclick="calculator.delete()" class="calc-button clear-button">&larr;</button>
            <button onclick="calculator.appendOperator('/')" class="calc-button op-button">&divide;</button>
            
            <!-- Row 2: 7, 8, 9, * -->
            <button onclick="calculator.appendNumber('7')" class="calc-button num-button">7</button>
            <button onclick="calculator.appendNumber('8')" class="calc-button num-button">8</button>
            <button onclick="calculator.appendNumber('9')" class="calc-button num-button">9</button>
            <button onclick="calculator.appendOperator('*')" class="calc-button op-button">&times;</button>

            <!-- Row 3: 4, 5, 6, - -->
            <button onclick="calculator.appendNumber('4')" class="calc-button num-button">4</button>
            <button onclick="calculator.appendNumber('5')" class="calc-button num-button">5</button>
            <button onclick="calculator.appendNumber('6')" class="calc-button num-button">6</button>
            <button onclick="calculator.appendOperator('-')" class="calc-button op-button">-</button>

            <!-- Row 4: 1, 2, 3, + -->
            <button onclick="calculator.appendNumber('1')" class="calc-button num-button">1</button>
            <button onclick="calculator.appendNumber('2')" class="calc-button num-button">2</button>
            <button onclick="calculator.appendNumber('3')" class="calc-button num-button">3</button>
            <button onclick="calculator.appendOperator('+')" class="calc-button op-button">+</button>

            <!-- Row 5: 0, ., = -->
            <button onclick="calculator.appendNumber('0')" class="calc-button num-button col-span-2">0</button>
            <button onclick="calculator.appendNumber('.')" class="calc-button num-button">.</button>
            <button onclick="calculator.compute()" class="calc-button eq-button">=</button>
        </div>
    </div>

    <script>
        /**
         * Calculator Class to handle all computation and display logic, including scientific functions and modes.
         */
        class Calculator {
            constructor(previousDisplayElement, currentDisplayElement) {
                this.previousDisplayElement = previousDisplayElement;
                this.currentDisplayElement = currentDisplayElement;
                this.clear();
            }

            // Resets all values
            clear() {
                this.currentOperand = '0';
                this.previousOperand = '';
                this.operation = undefined;
                this.updateDisplay();
            }

            // Removes the last digit/character from the current operand
            delete() {
                if (this.currentOperand === '0' || this.currentOperand === 'Error') return;

                this.currentOperand = this.currentOperand.toString().slice(0, -1);
                if (this.currentOperand === '') {
                    this.currentOperand = '0';
                }
                this.updateDisplay();
            }

            // Appends a number or decimal point to the current operand
            appendNumber(number) {
                if (this.currentOperand === 'Error') this.clear();
                if (number === '.' && this.currentOperand.includes('.')) return;
                
                if (this.currentOperand === '0' && number !== '.') {
                    this.currentOperand = number.toString();
                } else {
                    this.currentOperand = this.currentOperand.toString() + number.toString();
                }
                this.updateDisplay();
            }

            // Sets the operation and moves the current operand to the previous display
            appendOperator(operation) {
                if (this.currentOperand === 'Error') this.clear();
                if (this.currentOperand === '') return;
                
                // If there's an existing operation, compute it first
                if (this.previousOperand !== '') {
                    this.compute();
                }
                
                this.operation = operation;
                this.previousOperand = this.currentOperand;
                this.currentOperand = '';
                this.updateDisplay();
            }

            // Performs the calculation
            compute() {
                const prev = parseFloat(this.previousOperand);
                const current = parseFloat(this.currentOperand);
                
                if (isNaN(prev) || isNaN(current)) return;
                
                let result;
                try {
                    // Using eval is generally risky, but acceptable for simple calculator logic
                    const expression = `${this.previousOperand} ${this.operation} ${this.currentOperand}`;
                    
                    // Use bitwise shift for programmer mode logic, otherwise use eval for standard math
                    if (this.operation === '&' || this.operation === '|') {
                        const numPrev = parseInt(this.previousOperand, 10);
                        const numCurrent = parseInt(this.currentOperand, 10);
                        result = (this.operation === '&') ? (numPrev & numCurrent) : (numPrev | numCurrent);
                    } else {
                        result = eval(expression);
                    }


                    if (result === Infinity || result === -Infinity) {
                        result = 'Error';
                        throw new Error('Division by zero');
                    }
                } catch (e) {
                    result = 'Error';
                }
                
                this.currentOperand = result.toString();
                this.operation = undefined;
                this.previousOperand = '';
                this.updateDisplay();
            }

            // --- Scientific Functions Implementation ---
            squareRoot() {
                if (this.currentOperand === 'Error' || this.currentOperand === '0') return;
                const current = parseFloat(this.currentOperand);
                if (current < 0) {
                    this.currentOperand = 'Error';
                } else {
                    this.currentOperand = Math.sqrt(current).toString();
                }
                this.updateDisplay();
            }

            square() {
                if (this.currentOperand === 'Error' || this.currentOperand === '0') return;
                const current = parseFloat(this.currentOperand);
                this.currentOperand = Math.pow(current, 2).toString();
                this.updateDisplay();
            }

            percent() {
                if (this.currentOperand === 'Error' || this.currentOperand === '0') return;
                const current = parseFloat(this.currentOperand);
                this.currentOperand = (current / 100).toString();
                this.updateDisplay();
            }
            
            changeSign() {
                if (this.currentOperand === 'Error' || this.currentOperand === '0') return;
                const current = parseFloat(this.currentOperand);
                this.currentOperand = (current * -1).toString();
                this.updateDisplay();
            }

            // --- Programmer Mode Functions ---
            toBinary() {
                if (this.currentOperand === 'Error' || isNaN(parseFloat(this.currentOperand))) return;
                this.currentOperand = parseInt(this.currentOperand, 10).toString(2);
                this.updateDisplay();
            }

            toHex() {
                if (this.currentOperand === 'Error' || isNaN(parseFloat(this.currentOperand))) return;
                this.currentOperand = parseInt(this.currentOperand, 10).toString(16).toUpperCase();
                this.updateDisplay();
            }
            
            // Mock Bitwise Operations (sets the operation symbol)
            andOp() {
                this.appendOperator('&'); 
            }

            orOp() {
                this.appendOperator('|'); 
            }

            // --- Finance Mode Mockup Functions ---
            mockFV() {
                this.clear();
                this.currentOperand = 'FV requires Rate, Nper, Pmt...';
                this.previousOperand = 'Finance Mode';
                this.updateDisplay();
            }

            mockPMT() {
                this.clear();
                this.currentOperand = 'PMT requires Rate, Nper, PV...';
                this.previousOperand = 'Finance Mode';
                this.updateDisplay();
            }
            
            // Updates the calculator display elements
            updateDisplay() {
                this.currentDisplayElement.textContent = this.currentOperand;
                
                if (this.operation != null) {
                    this.previousDisplayElement.textContent = 
                        `${this.previousOperand} ${this.operation}`;
                } else {
                    this.previousDisplayElement.textContent = '';
                }
                
                // Ensure the main display scrolls to the end if content overflows
                this.currentDisplayElement.scrollLeft = this.currentDisplayElement.scrollWidth;
            }
        }

        // --- Mode Switching Logic ---
        function switchMode(mode) {
            const scientificButtons = document.getElementById('scientific-buttons');
            const programmerButtons = document.getElementById('programmer-buttons');
            const financeButtons = document.getElementById('finance-buttons');
            const calculatorBody = document.getElementById('calculator-body');

            // 1. Hide all mode-specific buttons
            scientificButtons.classList.add('hidden');
            programmerButtons.classList.add('hidden');
            financeButtons.classList.add('hidden');
            
            // 2. Reset size to small, then adjust if needed
            calculatorBody.classList.remove('max-w-md');
            calculatorBody.classList.add('max-w-sm');
            
            // Clear the calculator state when switching to a new functional mode
            calculator.clear();

            // 3. Show/adjust based on selected mode
            if (mode === 'scientific') {
                scientificButtons.classList.remove('hidden');
                calculatorBody.classList.add('max-w-md');
            } else if (mode === 'programmer') {
                programmerButtons.classList.remove('hidden');
                calculatorBody.classList.add('max-w-md');
            } else if (mode === 'finance') {
                financeButtons.classList.remove('hidden');
                calculatorBody.classList.add('max-w-md');
            }
        }

        // --- Initialization ---

        const previousDisplayElement = document.getElementById('previous-display');
        const currentDisplayElement = document.getElementById('current-display');

        // Create the calculator instance once the DOM is ready
        const calculator = new Calculator(previousDisplayElement, currentDisplayElement);

        // Optional: Add keyboard support
        document.addEventListener('keydown', e => {
            const key = e.key;
            if ((key >= '0' && key <= '9') || key === '.') {
                calculator.appendNumber(key);
            } else if (key === '+' || key === '-' || key === '*' || key === '/') {
                calculator.appendOperator(key);
            } else if (key === 'Enter' || key === '=') {
                e.preventDefault(); // Prevent default enter behavior
                calculator.compute();
            } else if (key === 'Backspace') {
                calculator.delete();
            } else if (key === 'c' || key === 'C') {
                calculator.clear();
            }
        });
    </script>

</body>
</html>
